<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è‚¡ç¥¨äº¤æ˜“æ¨¡æ‹Ÿå™¨ ğŸ“ˆ</title>
  
    <!-- è®¾ç½®PNGæ ¼å¼çš„ç½‘é¡µå›¾æ ‡ -->
    <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACpUlEQVQ4jW2TTWicVRSGn3POvd9/ZiJiO2baNFEHpNCVWhVdSIqUqlARqtCVP5iK2qBLQRfdKioodeHChSu1CxWlFIxdulK3hTYhmiKWKNWS1s5M833HxWRioF643PfCeX8u3Fe4aR1Kreo+6WJzojoD6uAr1PZdffXSt3BquH1atl+sevFpF3tfRKcARBQhAIIQCWSrSZMs/L3+5tdbnDEIrfm3kHhSVFuIgCiCogTEA0EyomftKOUzk+HQtfUbZ37YSmDVC0fQ5HNEZBxKUSBBPRJJiWQknhHJiZK6OYeX1p/7RuCRTCd6yyJxCpGtN5WtFhvXDRkEUgoSzwiSEiUj15LMi1+5crFnVs09JZo8P3IeCXRmO7xy8nXKepY/LvxG2EhIJCfTgoyCXCqy0Jositt/MknuWxCxe8be3Tu6HHvvOJPtFoPLOTs6e7h8fo2EgsxLMi3JrUXBLeTeXgsOM7gjYuy+axfH3n6ZqiixAdy5L0Ou38r+J+aY7DT0LwWWTl8k8YoiTJCQzYRo5vsfPEgo4LH5A1RZiQ1BNqCdGvvuzTnfB20MzZXe/QV//niVRCpSTT08O//GL7d1d7JjbyCaYP+ANWAOWkMqynQ3ZeXnGmmEoijp7i24dkEIxqp2Z3d+3+lF0lqIfbA+hAHEwehMhrB7KjA7HQmDQLwhRFXa00IaWZQPTnuaDH0pwi6tR87B/0sRmhEOQP8vZ/Uc/L4CwzWWJyb0bgH45JQfju5faoOMCdqAAnEstik4wt6sLjePH30nntnqwmef+mvq/q41aPBNgWb01wObZAdF6kCz8MBL9tFNZfrqYz9ozodSe083Y6uPtgFBOYfXrz50PJ793zYCfHHErfUwjxoc0Jo9RuNSs6LWLC5eCWdPnJBm+/y/I+rP9lcVEWcAAAAASUVORK5CYII=" type="image/png">
    
    <link rel="icon" sizes="32x32" href="data:image/png;base64,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" type="image/png">
    <link rel="icon" sizes="48x48" href="data:image/png;base64,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" type="image/png">


  <!-- å¼•å…¥å¤–éƒ¨èµ„æº -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
  
  <!-- Tailwindé…ç½® -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#165DFF',
            success: '#00B42A',
            danger: '#F53F3F',
            neutral: '#86909C',
            dark: '#1D2129',
            light: '#F2F3F5'
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <!-- è‡ªå®šä¹‰å·¥å…·ç±» -->
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .card-shadow {
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      }
      .transition-custom {
        transition: all 0.3s ease;
      }
      .price-up {
        animation: pulse-up 0.5s ease;
      }
      .price-down {
        animation: pulse-down 0.5s ease;
      }
      @keyframes pulse-up {
        0%, 100% { background-color: transparent; }
        50% { background-color: rgba(0, 180, 42, 0.1); }
      }
      @keyframes pulse-down {
        0%, 100% { background-color: transparent; }
        50% { background-color: rgba(245, 63, 63, 0.1); }
      }
    }
  </style>
</head>
<body class="bg-gray-50 font-sans text-dark">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <header class="bg-white shadow-sm sticky top-0 z-50">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
      <div class="flex items-center space-x-2">
        <i class="fa fa-line-chart text-primary text-2xl"></i>
        <h1 class="text-xl font-bold text-dark">è‚¡ç¥¨äº¤æ˜“æ¨¡æ‹Ÿå™¨ ğŸ“Š</h1>
      </div>
      <div class="flex items-center space-x-4">
        <button id="restart-btn" class="bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-lg transition-custom flex items-center">
          <i class="fa fa-refresh mr-2"></i>é‡æ–°å¼€å§‹ ğŸ”„
        </button>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 py-6">
    <!-- èµ„é‡‘ä¿¡æ¯å¡ç‰‡ -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
      <div class="bg-white rounded-xl p-6 card-shadow">
        <div class="flex justify-between items-start mb-4">
          <h2 class="text-neutral font-medium">å¯ç”¨èµ„é‡‘ ğŸ’°</h2>
          <i class="fa fa-money text-primary text-xl"></i>
        </div>
        <p id="balance" class="text-2xl font-bold">Â¥0</p>
      </div>
      
      <div class="bg-white rounded-xl p-6 card-shadow">
        <div class="flex justify-between items-start mb-4">
          <h2 class="text-neutral font-medium">æŒä»“å¸‚å€¼ ğŸ“¦</h2>
          <i class="fa fa-shopping-bag text-success text-xl"></i>
        </div>
        <p id="holdings-value" class="text-2xl font-bold">Â¥0</p>
      </div>
      
      <div class="bg-white rounded-xl p-6 card-shadow">
        <div class="flex justify-between items-start mb-4">
          <h2 class="text-neutral font-medium">æ€»èµ„äº§ ğŸ’</h2>
          <i class="fa fa-pie-chart text-dark text-xl"></i>
        </div>
        <p id="total-assets" class="text-2xl font-bold">Â¥0</p>
      </div>
    </div>
    
    <!-- ä¸»è¦å†…å®¹åŒº -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- å·¦ä¾§ï¼šè‚¡ç¥¨åˆ—è¡¨ -->
      <div class="lg:col-span-1">
        <div class="bg-white rounded-xl p-6 card-shadow h-full">
          <h2 class="text-lg font-bold mb-4 flex items-center">
            <i class="fa fa-list-ul text-primary mr-2"></i>è‚¡ç¥¨åˆ—è¡¨ ğŸ“‹
          </h2>
          
          <div class="relative mb-4">
            <input type="text" id="stock-search" placeholder="æœç´¢è‚¡ç¥¨..." 
                  class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50">
            <i class="fa fa-search absolute right-3 top-3 text-neutral"></i>
          </div>
          
          <div class="overflow-y-auto max-h-[calc(100vh-400px)]">
            <ul id="stock-list" class="space-y-2">
              <!-- è‚¡ç¥¨åˆ—è¡¨å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </ul>
          </div>
        </div>
      </div>
      
      <!-- ä¸­é—´å’Œå³ä¾§ï¼šKçº¿å›¾å’Œäº¤æ˜“åŒº -->
      <div class="lg:col-span-2 space-y-6">
        <!-- Kçº¿å›¾åŒºåŸŸ -->
        <div class="bg-white rounded-xl p-6 card-shadow">
          <div class="flex justify-between items-center mb-6">
            <div>
              <h2 id="current-stock-name" class="text-lg font-bold">è¯·é€‰æ‹©ä¸€æ”¯è‚¡ç¥¨</h2>
              <p id="current-stock-price" class="text-2xl font-bold mt-1">--</p>
            </div>
            
            <div class="flex space-x-2">
              <button class="timeframe-btn px-4 py-2 rounded-lg bg-primary text-white" data-timeframe="day">æ—¥K ğŸ“…</button>
              <button class="timeframe-btn px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-custom" data-timeframe="week">å‘¨K ğŸ—“ï¸</button>
              <button class="timeframe-btn px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-custom" data-timeframe="month">æœˆK ğŸ“†</button>
            </div>
          </div>
          
          <div class="h-[400px]">
            <canvas id="stock-chart"></canvas>
          </div>
        </div>
        
        <!-- äº¤æ˜“æ“ä½œåŒº -->
        <div class="bg-white rounded-xl p-6 card-shadow">
          <h2 class="text-lg font-bold mb-4 flex items-center">
            <i class="fa fa-exchange text-primary mr-2"></i>äº¤æ˜“æ“ä½œ ğŸ”„
          </h2>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-neutral mb-2">äº¤æ˜“æ•°é‡ ğŸ“</label>
              <div class="flex">
                <button id="decrease-qty" class="bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-l-lg transition-custom">
                  <i class="fa fa-minus"></i>
                </button>
                <input type="number" id="trade-quantity" min="1" value="1" 
                      class="w-full border-y border-gray-200 px-4 py-2 text-center focus:outline-none">
                <button id="increase-qty" class="bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-r-lg transition-custom">
                  <i class="fa fa-plus"></i>
                </button>
              </div>
              
              <div class="mt-4">
                <label class="block text-neutral mb-2">ä¼°è®¡æ€»é¢ ğŸ’´</label>
                <p id="estimated-total" class="text-xl font-bold">Â¥0</p>
              </div>
            </div>
            
            <div class="flex flex-col justify-between">
              <div>
                <button id="buy-btn" class="w-full bg-success hover:bg-success/90 text-white py-3 rounded-lg transition-custom mb-3 flex items-center justify-center">
                  <i class="fa fa-arrow-down mr-2"></i>ä¹°å…¥ ğŸ›’
                </button>
                <div class="flex gap-2">
                  <button id="sell-btn" class="flex-1 bg-danger hover:bg-danger/90 text-white py-3 rounded-lg transition-custom flex items-center justify-center opacity-50 cursor-not-allowed" disabled>
                    <i class="fa fa-arrow-up mr-2"></i>å–å‡º ğŸ“¤
                  </button>
                  <button id="sell-all-btn" class="w-12 bg-danger/80 hover:bg-danger text-white py-3 rounded-lg transition-custom flex items-center justify-center opacity-50 cursor-not-allowed" disabled title="å…¨å–">
                    <i class="fa fa-level-up"></i>
                  </button>
                </div>
              </div>
              
              <div id="holding-info" class="mt-4 p-4 bg-light rounded-lg hidden">
                <p class="text-neutral mb-1">å½“å‰æŒä»“: <span id="holding-quantity">0</span> è‚¡ ğŸ“Š</p>
                <p class="text-neutral">æŒä»“æˆæœ¬: <span id="average-cost">Â¥0</span> /è‚¡ ğŸ·ï¸</p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- äº¤æ˜“å†å² -->
        <div class="bg-white rounded-xl p-6 card-shadow">
          <h2 class="text-lg font-bold mb-4 flex items-center">
            <i class="fa fa-history text-primary mr-2"></i>äº¤æ˜“å†å² ğŸ•’
          </h2>
          
          <div class="overflow-x-auto">
            <table class="min-w-full">
              <thead>
                <tr class="border-b border-gray-200">
                  <th class="py-3 text-left text-sm font-medium text-neutral">æ—¶é—´</th>
                  <th class="py-3 text-left text-sm font-medium text-neutral">è‚¡ç¥¨</th>
                  <th class="py-3 text-left text-sm font-medium text-neutral">æ“ä½œ</th>
                  <th class="py-3 text-left text-sm font-medium text-neutral">æ•°é‡</th>
                  <th class="py-3 text-left text-sm font-medium text-neutral">ä»·æ ¼</th>
                  <th class="py-3 text-left text-sm font-medium text-neutral">æ€»é¢</th>
                </tr>
              </thead>
              <tbody id="transaction-history">
                <!-- äº¤æ˜“å†å²å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                <tr>
                  <td colspan="6" class="py-6 text-center text-neutral">æš‚æ— äº¤æ˜“è®°å½•</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </main>
  
  <!-- æ¸¸æˆç»“æŸæ¨¡æ€æ¡† -->
  <div id="game-over-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
      <div class="text-center">
        <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-danger/10 text-danger mb-4">
          <i class="fa fa-times text-2xl"></i>
        </div>
        <h2 class="text-2xl font-bold mb-2">æ¸¸æˆç»“æŸ âŒ</h2>
        <p class="text-neutral mb-6">å¾ˆé—æ†¾ï¼Œä½ çš„èµ„é‡‘å·²å…¨éƒ¨äºå®Œ ğŸ˜¢</p>
        <button id="restart-modal-btn" class="bg-primary hover:bg-primary/90 text-white px-6 py-3 rounded-lg transition-custom w-full">
          é‡æ–°å¼€å§‹ ğŸ”„
        </button>
      </div>
    </div>
  </div>

  <script>
    // è‚¡ç¥¨æ•°æ®æ¨¡å‹ - åŒ…å«10æ”¯ä¸åŒè¡Œä¸šçš„è‚¡ç¥¨
    const stocks = [
      { id: 1, code: '600000', name: 'æµ¦å‘é“¶è¡Œ', price: 10.25, volatility: 0.03, lastPrice: 10.25 },
      { id: 2, code: '600036', name: 'æ‹›å•†é“¶è¡Œ', price: 35.78, volatility: 0.04, lastPrice: 35.78 },
      { id: 3, code: '601318', name: 'ä¸­å›½å¹³å®‰', price: 48.32, volatility: 0.05, lastPrice: 48.32 },
      { id: 4, code: '600519', name: 'è´µå·èŒ…å°', price: 1780.50, volatility: 0.02, lastPrice: 1780.50 },
      { id: 5, code: '000858', name: 'äº”ç²®æ¶²', price: 165.30, volatility: 0.03, lastPrice: 165.30 },
      { id: 6, code: '000333', name: 'ç¾çš„é›†å›¢', price: 56.80, volatility: 0.035, lastPrice: 56.80 },
      { id: 7, code: '000651', name: 'æ ¼åŠ›ç”µå™¨', price: 32.45, volatility: 0.04, lastPrice: 32.45 },
      { id: 8, code: '601899', name: 'ç´«é‡‘çŸ¿ä¸š', price: 9.75, volatility: 0.06, lastPrice: 9.75 },
      { id: 9, code: '600031', name: 'ä¸‰ä¸€é‡å·¥', price: 28.60, volatility: 0.05, lastPrice: 28.60 },
      { id: 10, code: '601668', name: 'ä¸­å›½å»ºç­‘', price: 5.20, volatility: 0.025, lastPrice: 5.20 }
    ];
    
    // æ¸¸æˆçŠ¶æ€
    let gameState = {
      balance: 100000, // åˆå§‹èµ„é‡‘10ä¸‡å…ƒ
      holdings: {}, // æŒä»“ { stockId: { quantity: number, avgCost: number } }
      transactions: [] // äº¤æ˜“å†å²
    };
    
    // å½“å‰é€‰ä¸­çš„è‚¡ç¥¨
    let currentStock = null;
    let currentTimeframe = 'day';
    let priceUpdateInterval;
    
    // å›¾è¡¨å®ä¾‹
    let stockChart = null;
    
    // DOMå…ƒç´ 
    const balanceEl = document.getElementById('balance');
    const holdingsValueEl = document.getElementById('holdings-value');
    const totalAssetsEl = document.getElementById('total-assets');
    const stockListEl = document.getElementById('stock-list');
    const currentStockNameEl = document.getElementById('current-stock-name');
    const currentStockPriceEl = document.getElementById('current-stock-price');
    const timeframeBtns = document.querySelectorAll('.timeframe-btn');
    const tradeQuantityEl = document.getElementById('trade-quantity');
    const estimatedTotalEl = document.getElementById('estimated-total');
    const buyBtn = document.getElementById('buy-btn');
    const sellBtn = document.getElementById('sell-btn');
    const sellAllBtn = document.getElementById('sell-all-btn');
    const decreaseQtyBtn = document.getElementById('decrease-qty');
    const increaseQtyBtn = document.getElementById('increase-qty');
    const holdingInfoEl = document.getElementById('holding-info');
    const holdingQuantityEl = document.getElementById('holding-quantity');
    const averageCostEl = document.getElementById('average-cost');
    const transactionHistoryEl = document.getElementById('transaction-history');
    const restartBtn = document.getElementById('restart-btn');
    const restartModalBtn = document.getElementById('restart-modal-btn');
    const gameOverModal = document.getElementById('game-over-modal');
    const stockSearchEl = document.getElementById('stock-search');
    
    // åˆå§‹åŒ–
    function init() {
      // ä»CookieåŠ è½½æ¸¸æˆçŠ¶æ€
      loadGameState();
      
      // æ¸²æŸ“è‚¡ç¥¨åˆ—è¡¨
      renderStockList();
      
      // æ›´æ–°èµ„é‡‘ä¿¡æ¯
      updateFinancialInfo();
      
      // æ¸²æŸ“äº¤æ˜“å†å²
      renderTransactionHistory();
      
      // è®¾ç½®äº‹ä»¶ç›‘å¬
      setupEventListeners();
      
      // å¯åŠ¨ä»·æ ¼å®æ—¶æ›´æ–°
      startPriceUpdates();
    }
    
    // å¯åŠ¨ä»·æ ¼å®æ—¶æ›´æ–°
    function startPriceUpdates() {
      // æ¯5ç§’æ›´æ–°ä¸€æ¬¡ä»·æ ¼
      priceUpdateInterval = setInterval(() => {
        updateAllStockPrices();
      }, 5000);
    }
    
    // æ›´æ–°æ‰€æœ‰è‚¡ç¥¨ä»·æ ¼
    function updateAllStockPrices() {
      let pricesChanged = false;
      
      stocks.forEach(stock => {
        const oldPrice = stock.price;
        // åŸºäºæ³¢åŠ¨ç‡éšæœºå˜åŠ¨ä»·æ ¼ï¼Œä½†å˜åŠ¨å¹…åº¦é™åˆ¶åœ¨Â±3%ä»¥å†…
        const maxChange = stock.price * stock.volatility;
        const change = (Math.random() - 0.5) * 2 * maxChange;
        stock.lastPrice = stock.price;
        stock.price += change;
        
        // ç¡®ä¿ä»·æ ¼ä¸ä¼šä¸ºè´Ÿ
        if (stock.price < 0.01) stock.price = 0.01;
        
        if (oldPrice !== stock.price) {
          pricesChanged = true;
        }
      });
      
      // å¦‚æœä»·æ ¼æœ‰å˜åŒ–ï¼Œæ›´æ–°UI
      if (pricesChanged) {
        // æ›´æ–°å½“å‰é€‰ä¸­è‚¡ç¥¨çš„ä»·æ ¼
        if (currentStock) {
          const updatedStock = stocks.find(s => s.id === currentStock.id);
          if (updatedStock) {
            currentStock.currentPrice = updatedStock.price;
            
            // æ›´æ–°ä»·æ ¼æ˜¾ç¤ºå¹¶æ·»åŠ åŠ¨ç”»æ•ˆæœ
            const priceEl = currentStockPriceEl;
            priceEl.textContent = `Â¥${currentStock.currentPrice.toFixed(2)}`;
            
            if (updatedStock.price > updatedStock.lastPrice) {
              priceEl.className = `text-2xl font-bold mt-1 text-success price-up`;
            } else if (updatedStock.price < updatedStock.lastPrice) {
              priceEl.className = `text-2xl font-bold mt-1 text-danger price-down`;
            }
            
            // ç§»é™¤åŠ¨ç”»ç±»ä»¥å…è®¸ä¸‹æ¬¡åŠ¨ç”»
            setTimeout(() => {
              priceEl.classList.remove('price-up', 'price-down');
            }, 500);
            
            // æ›´æ–°ä¼°è®¡æ€»é¢
            updateEstimatedTotal();
            
            // æ›´æ–°å›¾è¡¨
            if (stockChart) {
              updateChartWithNewPrice();
            }
          }
        }
        
        // é‡æ–°æ¸²æŸ“è‚¡ç¥¨åˆ—è¡¨ï¼Œä½†ä¿æŒå½“å‰é€‰ä¸­çŠ¶æ€
        const filter = stockSearchEl.value.trim();
        const selectedId = currentStock?.id;
        renderStockList(filter);
        
        // é‡æ–°é€‰ä¸­ä¹‹å‰é€‰æ‹©çš„è‚¡ç¥¨
        if (selectedId) {
          const items = stockListEl.querySelectorAll('li');
          items.forEach(item => {
            // ç®€å•æ£€æŸ¥è‚¡ç¥¨IDæ˜¯å¦åŒ¹é…
            if (item.textContent.includes(stocks.find(s => s.id === selectedId)?.code)) {
              item.classList.add('bg-primary/10');
            }
          });
        }
        
        // æ›´æ–°è´¢åŠ¡ä¿¡æ¯
        updateFinancialInfo();
      }
    }
    
    // æ›´æ–°å›¾è¡¨çš„æœ€æ–°ä»·æ ¼
    function updateChartWithNewPrice() {
      if (!stockChart || !currentStock) return;
      
      // åªæ›´æ–°æœ€åä¸€ä¸ªæ•°æ®ç‚¹ï¼Œè€Œä¸æ˜¯é‡ç»˜æ•´ä¸ªå›¾è¡¨
      const data = stockChart.data.datasets[0].data;
      data[data.length - 1] = currentStock.currentPrice;
      stockChart.update('none'); // æ— åŠ¨ç”»æ›´æ–°ï¼Œæé«˜æ€§èƒ½
    }
    
    // ä»CookieåŠ è½½æ¸¸æˆçŠ¶æ€
    function loadGameState() {
      const savedState = getCookie('stockGameState');
      if (savedState) {
        try {
          gameState = JSON.parse(savedState);
        } catch (e) {
          console.error('ä»Cookieè§£ææ¸¸æˆçŠ¶æ€å¤±è´¥', e);
          // ä¿ç•™åˆå§‹çŠ¶æ€
        }
      }
      
      // æ£€æŸ¥æ˜¯å¦å·²ç»ç ´äº§
      checkGameOver();
    }
    
    // ä¿å­˜æ¸¸æˆçŠ¶æ€åˆ°Cookie
    function saveGameState() {
      setCookie('stockGameState', JSON.stringify(gameState), 365);
    }
    
    // è®¾ç½®Cookie
    function setCookie(name, value, days) {
      const date = new Date();
      date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
      const expires = "expires=" + date.toUTCString();
      document.cookie = name + "=" + value + ";" + expires + ";path=/";
    }
    
    // è·å–Cookie
    function getCookie(name) {
      const nameEQ = name + "=";
      const ca = document.cookie.split(';');
      for (let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) === ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
      }
      return null;
    }
    
    // æ¸…é™¤Cookie
    function clearCookie(name) {
      setCookie(name, "", -1);
    }
    
    // æ¸²æŸ“è‚¡ç¥¨åˆ—è¡¨
    function renderStockList(filter = '') {
      stockListEl.innerHTML = '';
      
      const filteredStocks = stocks.filter(stock => 
        stock.name.includes(filter) || stock.code.includes(filter)
      );
      
      filteredStocks.forEach(stock => {
        const li = document.createElement('li');
        li.className = `p-3 rounded-lg hover:bg-light transition-custom cursor-pointer ${currentStock?.id === stock.id ? 'bg-primary/10' : ''}`;
        
        // ä»·æ ¼å˜åŠ¨æ–¹å‘å’Œæ ·å¼
        let priceClass = '';
        let priceChangeIcon = '';
        
        if (stock.price > stock.lastPrice) {
          priceClass = 'text-success';
          priceChangeIcon = 'ğŸ“ˆ';
        } else if (stock.price < stock.lastPrice) {
          priceClass = 'text-danger';
          priceChangeIcon = 'ğŸ“‰';
        } else {
          priceClass = 'text-neutral';
          priceChangeIcon = 'ğŸ“Š';
        }
        
        li.innerHTML = `
          <div class="flex justify-between items-start">
            <div>
              <div class="font-medium">${stock.name}</div>
              <div class="text-sm text-neutral">${stock.code}</div>
            </div>
            <div class="text-right">
              <div class="font-bold">Â¥${stock.price.toFixed(2)}</div>
              <div class="${priceClass} text-sm">
                ${priceChangeIcon} ${getPriceChangePercent(stock)}
              </div>
            </div>
          </div>
        `;
        
        li.addEventListener('click', () => selectStock(stock));
        stockListEl.appendChild(li);
      });
    }
    
    // è·å–ä»·æ ¼å˜åŠ¨ç™¾åˆ†æ¯”
    function getPriceChangePercent(stock) {
      const change = stock.price - stock.lastPrice;
      const percent = (change / stock.lastPrice) * 100;
      return change > 0 ? `+${percent.toFixed(2)}%` : 
             change < 0 ? `${percent.toFixed(2)}%` : '0%';
    }
    
    // é€‰æ‹©è‚¡ç¥¨
    function selectStock(stock) {
      currentStock = { ...stock, currentPrice: stock.price };
      
      // æ›´æ–°UI
      document.querySelectorAll('#stock-list li').forEach(li => {
        li.classList.remove('bg-primary/10');
      });
      event.currentTarget.classList.add('bg-primary/10');
      
      currentStockNameEl.textContent = `${currentStock.name} (${currentStock.code})`;
      currentStockPriceEl.textContent = `Â¥${currentStock.currentPrice.toFixed(2)}`;
      
      // è®¾ç½®ä»·æ ¼é¢œè‰²
      if (currentStock.price > currentStock.lastPrice) {
        currentStockPriceEl.className = 'text-2xl font-bold mt-1 text-success';
      } else if (currentStock.price < currentStock.lastPrice) {
        currentStockPriceEl.className = 'text-2xl font-bold mt-1 text-danger';
      } else {
        currentStockPriceEl.className = 'text-2xl font-bold mt-1 text-neutral';
      }
      
      // æ›´æ–°ä¼°è®¡æ€»é¢
      updateEstimatedTotal();
      
      // æ˜¾ç¤ºæŒä»“ä¿¡æ¯
      showHoldingInfo();
      
      // ç»˜åˆ¶Kçº¿å›¾
      renderStockChart();
    }
    
    // ç»˜åˆ¶è‚¡ç¥¨å›¾è¡¨
    function renderStockChart() {
      if (!currentStock) return;
      
      const ctx = document.getElementById('stock-chart').getContext('2d');
      
      // ç”Ÿæˆæ¨¡æ‹Ÿçš„å†å²æ•°æ®
      const data = generateHistoricalData();
      
      // å¦‚æœå›¾è¡¨å·²å­˜åœ¨ï¼Œé”€æ¯å®ƒ
      if (stockChart) {
        stockChart.destroy();
      }
      
      // åˆ›å»ºæ–°å›¾è¡¨
      stockChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.labels,
          datasets: [{
            label: 'è‚¡ä»·',
            data: data.prices,
            borderColor: '#165DFF',
            backgroundColor: 'rgba(22, 93, 255, 0.1)',
            borderWidth: 2,
            fill: true,
            tension: 0.2,
            pointRadius: 0,
            pointHoverRadius: 4,
            pointBackgroundColor: '#165DFF'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false,
          },
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.7)',
              padding: 10,
              titleFont: {
                size: 14
              },
              bodyFont: {
                size: 13
              },
              callbacks: {
                label: function(context) {
                  return `ä»·æ ¼: Â¥${context.raw.toFixed(2)}`;
                }
              }
            }
          },
          scales: {
            x: {
              grid: {
                display: false
              }
            },
            y: {
              beginAtZero: false,
              ticks: {
                callback: function(value) {
                  return 'Â¥' + value.toFixed(2);
                }
              }
            }
          },
          animation: {
            duration: 0 // ç¦ç”¨åŠ¨ç”»ä»¥æé«˜æ€§èƒ½
          }
        }
      });
    }
    
    // ç”Ÿæˆå†å²æ•°æ® - ä¿®å¤äº†æ—¶é—´åŒæ­¥é—®é¢˜
    function generateHistoricalData() {
      const labels = [];
      const prices = [];
      let count, dateFormat;
      
      // æ ¹æ®æ—¶é—´èŒƒå›´ç”Ÿæˆä¸åŒçš„æ•°æ®é‡
      switch (currentTimeframe) {
        case 'day':
          count = 24; // ä¸€å¤©24å°æ—¶
          dateFormat = 'HH:00';
          break;
        case 'week':
          count = 7; // ä¸€å‘¨7å¤©
          dateFormat = 'MM-DD';
          break;
        case 'month':
          count = 30; // ä¸€ä¸ªæœˆ30å¤©
          dateFormat = 'MM-DD';
          break;
      }
      
      // ç”Ÿæˆæ—¥æœŸæ ‡ç­¾å’Œä»·æ ¼æ•°æ®
      for (let i = 0; i < count; i++) {
        const date = new Date();
        
        if (currentTimeframe === 'day') {
          // ä»å½“å‰æ—¶é—´å€’æ¨23å°æ—¶ï¼Œç¡®ä¿æ—¶é—´è½´æ­£ç¡®
          const hoursToSubtract = count - 1 - i;
          date.setHours(date.getHours() - hoursToSubtract);
        } else if (currentTimeframe === 'week') {
          date.setDate(date.getDate() - (count - 1 - i));
        } else {
          date.setDate(date.getDate() - (count - 1 - i));
        }
        
        // æ ¼å¼åŒ–æ—¥æœŸ
        let label;
        if (dateFormat === 'HH:00') {
          label = date.getHours() + ':00';
        } else {
          label = (date.getMonth() + 1) + '-' + date.getDate();
        }
        
        labels.push(label);
        
        // ç”ŸæˆåŸºäºå½“å‰ä»·æ ¼çš„éšæœºå†å²ä»·æ ¼ï¼Œç¡®ä¿è¶‹åŠ¿åˆç†
        const basePrice = currentStock.price;
        const volatility = currentStock.volatility;
        
        // è®¡ç®—ä»·æ ¼è¶‹åŠ¿å› å­ï¼Œä½¿ä»·æ ¼å˜åŒ–æ›´è‡ªç„¶
        const trendFactor = 1 + (i - count/2) * 0.005;
        const randomFactor = 1 + (Math.random() - 0.5) * 2 * volatility;
        const price = basePrice * randomFactor * trendFactor;
        
        prices.push(price);
      }
      
      // æœ€åä¸€ä¸ªä»·æ ¼ä½¿ç”¨å½“å‰ä»·æ ¼ï¼Œç¡®ä¿ä¸å®æ—¶ä»·æ ¼åŒæ­¥
      prices[prices.length - 1] = currentStock.currentPrice;
      
      return { labels, prices };
    }
    
    // æ›´æ–°ä¼°è®¡æ€»é¢
    function updateEstimatedTotal() {
      if (!currentStock) {
        estimatedTotalEl.textContent = 'Â¥0';
        return;
      }
      
      const quantity = parseInt(tradeQuantityEl.value);
      const total = quantity * currentStock.currentPrice;
      estimatedTotalEl.textContent = `Â¥${total.toFixed(2)}`;
    }
    
    // æ˜¾ç¤ºæŒä»“ä¿¡æ¯
    function showHoldingInfo() {
      if (!currentStock) {
        holdingInfoEl.classList.add('hidden');
        return;
      }
      
      const holding = gameState.holdings[currentStock.id];
      
      if (holding && holding.quantity > 0) {
        holdingInfoEl.classList.remove('hidden');
        holdingQuantityEl.textContent = holding.quantity;
        averageCostEl.textContent = `Â¥${holding.avgCost.toFixed(2)}`;
        sellBtn.disabled = false;
        sellBtn.classList.remove('opacity-50', 'cursor-not-allowed');
        sellAllBtn.disabled = false;
        sellAllBtn.classList.remove('opacity-50', 'cursor-not-allowed');
      } else {
        holdingInfoEl.classList.add('hidden');
        sellBtn.disabled = true;
        sellBtn.classList.add('opacity-50', 'cursor-not-allowed');
        sellAllBtn.disabled = true;
        sellAllBtn.classList.add('opacity-50', 'cursor-not-allowed');
      }
    }
    
    // ä¸€é”®å¡«å…¥æ‰€æœ‰æŒä»“æ•°é‡
    function fillAllShares() {
      if (!currentStock) return;
      
      const holding = gameState.holdings[currentStock.id];
      if (holding && holding.quantity > 0) {
        tradeQuantityEl.value = holding.quantity;
        updateEstimatedTotal();
      }
    }
    
    // ä¹°å…¥è‚¡ç¥¨
    function buyStock() {
      if (!currentStock) return;
      
      const quantity = parseInt(tradeQuantityEl.value);
      const totalCost = quantity * currentStock.currentPrice;
      
      // æ£€æŸ¥ä½™é¢æ˜¯å¦è¶³å¤Ÿ
      if (totalCost > gameState.balance) {
        showNotification('ä½™é¢ä¸è¶³ï¼Œæ— æ³•å®Œæˆè´­ä¹° ğŸ˜¥', 'warning');
        return;
      }
      
      // æ›´æ–°æŒä»“
      if (gameState.holdings[currentStock.id]) {
        // å·²æŒæœ‰è¯¥è‚¡ç¥¨ï¼Œè®¡ç®—å¹³å‡æˆæœ¬
        const currentHolding = gameState.holdings[currentStock.id];
        const totalShares = currentHolding.quantity + quantity;
        const totalInvestment = (currentHolding.quantity * currentHolding.avgCost) + totalCost;
        const newAvgCost = totalInvestment / totalShares;
        
        gameState.holdings[currentStock.id] = {
          quantity: totalShares,
          avgCost: newAvgCost
        };
      } else {
        // é¦–æ¬¡è´­ä¹°è¯¥è‚¡ç¥¨
        gameState.holdings[currentStock.id] = {
          quantity: quantity,
          avgCost: currentStock.currentPrice
        };
      }
      
      // æ›´æ–°ä½™é¢
      gameState.balance -= totalCost;
      
      // è®°å½•äº¤æ˜“
      recordTransaction('ä¹°å…¥', quantity, currentStock.currentPrice, totalCost);
      
      // ä¿å­˜çŠ¶æ€å¹¶æ›´æ–°UI
      saveGameState();
      updateFinancialInfo();
      showHoldingInfo();
      renderTransactionHistory();
      
      // é‡ç½®äº¤æ˜“æ•°é‡
      tradeQuantityEl.value = 1;
      updateEstimatedTotal();
      
      // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
      showNotification(`æˆåŠŸä¹°å…¥ ${currentStock.name} ${quantity} è‚¡ ğŸ›’`);
    }
    
    // å–å‡ºè‚¡ç¥¨
    function sellStock() {
      if (!currentStock) return;
      
      const holding = gameState.holdings[currentStock.id];
      if (!holding || holding.quantity === 0) return;
      
      const quantity = parseInt(tradeQuantityEl.value);
      
      // æ£€æŸ¥æŒä»“æ˜¯å¦è¶³å¤Ÿ
      if (quantity > holding.quantity) {
        showNotification('æŒä»“ä¸è¶³ï¼Œæ— æ³•å®Œæˆå–å‡º ğŸ˜¥', 'warning');
        return;
      }
      
      const totalRevenue = quantity * currentStock.currentPrice;
      
      // æ›´æ–°æŒä»“
      if (quantity === holding.quantity) {
        // å…¨éƒ¨å–å‡º
        delete gameState.holdings[currentStock.id];
      } else {
        // éƒ¨åˆ†å–å‡ºï¼Œå¹³å‡æˆæœ¬ä¸å˜
        gameState.holdings[currentStock.id].quantity -= quantity;
      }
      
      // æ›´æ–°ä½™é¢
      gameState.balance += totalRevenue;
      
      // è®°å½•äº¤æ˜“
      recordTransaction('å–å‡º', quantity, currentStock.currentPrice, totalRevenue);
      
      // ä¿å­˜çŠ¶æ€å¹¶æ›´æ–°UI
      saveGameState();
      updateFinancialInfo();
      showHoldingInfo();
      renderTransactionHistory();
      
      // é‡ç½®äº¤æ˜“æ•°é‡
      tradeQuantityEl.value = 1;
      updateEstimatedTotal();
      
      // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
      const profit = totalRevenue - (quantity * holding.avgCost);
      let profitEmoji = 'ğŸ’¸';
      if (profit > 0) profitEmoji = 'ğŸ“ˆğŸ’°';
      else if (profit < 0) profitEmoji = 'ğŸ“‰ğŸ’¸';
      
      showNotification(`æˆåŠŸå–å‡º ${currentStock.name} ${quantity} è‚¡ ${profitEmoji}`);
    }
    
    // è®°å½•äº¤æ˜“
    function recordTransaction(type, quantity, price, total) {
      const stock = stocks.find(s => s.id === currentStock.id);
      
      gameState.transactions.push({
        id: Date.now(),
        timestamp: new Date().toLocaleString(),
        stockId: currentStock.id,
        stockName: stock.name,
        stockCode: stock.code,
        type: type,
        quantity: quantity,
        price: price,
        total: total
      });
      
      // åªä¿ç•™æœ€è¿‘100æ¡äº¤æ˜“è®°å½•ï¼Œå‡å°‘æ•°æ®é‡
      if (gameState.transactions.length > 100) {
        gameState.transactions.shift();
      }
    }
    
    // æ¸²æŸ“äº¤æ˜“å†å²
    function renderTransactionHistory() {
      if (gameState.transactions.length === 0) {
        transactionHistoryEl.innerHTML = `
          <tr>
            <td colspan="6" class="py-6 text-center text-neutral">æš‚æ— äº¤æ˜“è®°å½•</td>
          </tr>
        `;
        return;
      }
      
      transactionHistoryEl.innerHTML = '';
      
      // å€’åºæ˜¾ç¤ºï¼Œæœ€æ–°çš„äº¤æ˜“åœ¨å‰é¢
      const reversedTransactions = [...gameState.transactions].reverse();
      
      reversedTransactions.forEach(transaction => {
        const tr = document.createElement('tr');
        tr.className = 'border-b border-gray-100 hover:bg-light/50 transition-custom';
        
        const typeEmoji = transaction.type === 'ä¹°å…¥' ? 'ğŸ›’' : 'ğŸ“¤';
        
        tr.innerHTML = `
          <td class="py-3 text-sm">${transaction.timestamp}</td>
          <td class="py-3 text-sm">${transaction.stockName} (${transaction.stockCode})</td>
          <td class="py-3 text-sm">
            <span class="${transaction.type === 'ä¹°å…¥' ? 'text-success' : 'text-danger'}">
              ${transaction.type} ${typeEmoji}
            </span>
          </td>
          <td class="py-3 text-sm">${transaction.quantity}</td>
          <td class="py-3 text-sm">Â¥${transaction.price.toFixed(2)}</td>
          <td class="py-3 text-sm font-medium">Â¥${transaction.total.toFixed(2)}</td>
        `;
        transactionHistoryEl.appendChild(tr);
      });
    }
    
    // æ›´æ–°è´¢åŠ¡ä¿¡æ¯
    function updateFinancialInfo() {
      // è®¡ç®—æŒä»“æ€»ä»·å€¼
      let holdingsValue = 0;
      for (const stockId in gameState.holdings) {
        const holding = gameState.holdings[stockId];
        const stock = stocks.find(s => s.id === parseInt(stockId));
        if (stock) {
          // ä½¿ç”¨å½“å‰ä»·æ ¼è®¡ç®—å¸‚å€¼
          holdingsValue += holding.quantity * stock.price;
        }
      }
      
      // è®¡ç®—æ€»èµ„äº§
      const totalAssets = gameState.balance + holdingsValue;
      
      // æ›´æ–°UI
      balanceEl.textContent = `Â¥${gameState.balance.toFixed(2)}`;
      holdingsValueEl.textContent = `Â¥${holdingsValue.toFixed(2)}`;
      totalAssetsEl.textContent = `Â¥${totalAssets.toFixed(2)}`;
    }
    
    // æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
    function checkGameOver() {
      if (gameState.balance <= 0) {
        // æ£€æŸ¥æ˜¯å¦è¿˜æœ‰æŒä»“
        let hasHoldings = false;
        for (const stockId in gameState.holdings) {
          if (gameState.holdings[stockId].quantity > 0) {
            hasHoldings = true;
            break;
          }
        }
        
        if (!hasHoldings) {
          // èµ„é‡‘ä¸º0ä¸”æ— æŒä»“ï¼Œæ¸¸æˆç»“æŸ
          clearInterval(priceUpdateInterval); // åœæ­¢ä»·æ ¼æ›´æ–°
          gameOverModal.classList.remove('hidden');
        }
      }
    }
    
    // é‡æ–°å¼€å§‹æ¸¸æˆ
    function restartGame() {
      // é‡ç½®æ¸¸æˆçŠ¶æ€
      gameState = {
        balance: 100000,
        holdings: {},
        transactions: []
      };
      
      // é‡ç½®è‚¡ç¥¨ä»·æ ¼
      stocks.forEach(stock => {
        stock.lastPrice = stock.price;
      });
      
      // æ¸…é™¤Cookie
      clearCookie('stockGameState');
      
      // é‡ç½®UI
      currentStock = null;
      currentStockNameEl.textContent = 'è¯·é€‰æ‹©ä¸€æ”¯è‚¡ç¥¨';
      currentStockPriceEl.textContent = '--';
      currentStockPriceEl.className = 'text-2xl font-bold mt-1';
      tradeQuantityEl.value = 1;
      updateEstimatedTotal();
      showHoldingInfo();
      
      // é”€æ¯å›¾è¡¨
      if (stockChart) {
        stockChart.destroy();
        stockChart = null;
      }
      
      // æ›´æ–°UI
      updateFinancialInfo();
      renderStockList();
      renderTransactionHistory();
      
      // éšè—æ¨¡æ€æ¡†
      gameOverModal.classList.add('hidden');
      
      // é‡å¯ä»·æ ¼æ›´æ–°
      clearInterval(priceUpdateInterval);
      startPriceUpdates();
      
      // æ˜¾ç¤ºé€šçŸ¥
      showNotification('æ¸¸æˆå·²é‡æ–°å¼€å§‹ï¼Œåˆå§‹èµ„é‡‘10ä¸‡å…ƒ ğŸ†•');
    }
    
    // æ˜¾ç¤ºé€šçŸ¥
    function showNotification(message, type = 'info') {
      // åˆ›å»ºé€šçŸ¥å…ƒç´ 
      const notification = document.createElement('div');
      let bgColor = 'bg-dark';
      
      if (type === 'warning') {
        bgColor = 'bg-amber-600';
      } else if (type === 'success') {
        bgColor = 'bg-success';
      }
      
      notification.className = `fixed bottom-4 right-4 ${bgColor} text-white px-4 py-3 rounded-lg shadow-lg z-50 transform translate-y-10 opacity-0 transition-all duration-300`;
      notification.textContent = message;
      
      // æ·»åŠ åˆ°é¡µé¢
      document.body.appendChild(notification);
      
      // æ˜¾ç¤ºé€šçŸ¥
      setTimeout(() => {
        notification.classList.remove('translate-y-10', 'opacity-0');
      }, 10);
      
      // 3ç§’åéšè—é€šçŸ¥
      setTimeout(() => {
        notification.classList.add('translate-y-10', 'opacity-0');
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 300);
      }, 3000);
    }
    
    // è®¾ç½®äº‹ä»¶ç›‘å¬
    function setupEventListeners() {
      // æ—¶é—´èŒƒå›´æŒ‰é’®
      timeframeBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          // æ›´æ–°æŒ‰é’®æ ·å¼
          timeframeBtns.forEach(b => {
            b.classList.remove('bg-primary', 'text-white');
            b.classList.add('bg-gray-100', 'hover:bg-gray-200');
          });
          btn.classList.remove('bg-gray-100', 'hover:bg-gray-200');
          btn.classList.add('bg-primary', 'text-white');
          
          // æ›´æ–°æ—¶é—´èŒƒå›´å¹¶é‡æ–°ç»˜åˆ¶å›¾è¡¨
          currentTimeframe = btn.dataset.timeframe;
          renderStockChart();
        });
      });
      
      // æ•°é‡è°ƒæ•´æŒ‰é’®
      decreaseQtyBtn.addEventListener('click', () => {
        let quantity = parseInt(tradeQuantityEl.value);
        if (quantity > 1) {
          tradeQuantityEl.value = quantity - 1;
          updateEstimatedTotal();
        }
      });
      
      increaseQtyBtn.addEventListener('click', () => {
        let quantity = parseInt(tradeQuantityEl.value);
        tradeQuantityEl.value = quantity + 1;
        updateEstimatedTotal();
      });
      
      // äº¤æ˜“æ•°é‡è¾“å…¥å˜åŒ–
      tradeQuantityEl.addEventListener('input', () => {
        // ç¡®ä¿æœ€å°å€¼ä¸º1
        if (parseInt(tradeQuantityEl.value) < 1 || isNaN(parseInt(tradeQuantityEl.value))) {
          tradeQuantityEl.value = 1;
        }
        updateEstimatedTotal();
      });
      
      // ä¹°å…¥æŒ‰é’®
      buyBtn.addEventListener('click', buyStock);
      
      // å–å‡ºæŒ‰é’®
      sellBtn.addEventListener('click', sellStock);
      
      // å…¨å–æŒ‰é’®
      sellAllBtn.addEventListener('click', () => {
        fillAllShares();
        // è‡ªåŠ¨å–å‡ºï¼ˆå¯é€‰åŠŸèƒ½ï¼‰
        // sellStock();
      });
      
      // é‡æ–°å¼€å§‹æŒ‰é’®
      restartBtn.addEventListener('click', restartGame);
      restartModalBtn.addEventListener('click', restartGame);
      
      // è‚¡ç¥¨æœç´¢
      stockSearchEl.addEventListener('input', () => {
        const filter = stockSearchEl.value.trim();
        renderStockList(filter);
      });
      
      // é”®ç›˜å¿«æ·é”®
      document.addEventListener('keydown', (e) => {
        // é¿å…åœ¨è¾“å…¥æ¡†ä¸­ä½¿ç”¨å¿«æ·é”®
        if (document.activeElement.tagName === 'INPUT') return;
        
        // Bé”®ä¹°å…¥
        if (e.key === 'b' && currentStock) {
          buyStock();
        }
        // Sé”®å–å‡º
        if (e.key === 's' && currentStock && gameState.holdings[currentStock.id]) {
          sellStock();
        }
        // Aé”®å…¨å–
        if (e.key === 'a' && currentStock && gameState.holdings[currentStock.id]) {
          fillAllShares();
        }
      });
    }
    
    // é¡µé¢å…³é—­å‰ç¡®ä¿æ¸…ç†å®šæ—¶å™¨
    window.addEventListener('beforeunload', () => {
      clearInterval(priceUpdateInterval);
    });
    
    // å¯åŠ¨æ¸¸æˆ
    window.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
    
